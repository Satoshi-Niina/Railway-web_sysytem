# é‰„é“ä¿å®ˆã‚·ã‚¹ãƒ†ãƒ  (Railway Maintenance System)

é‰„é“è»Šä¸¡ã®é‹ç”¨ç®¡ç†ã€ä¿å®ˆè¨ˆç”»ã€æ¤œæŸ»è¨˜éŒ²ã‚’çµ±åˆçš„ã«ç®¡ç†ã™ã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

## ğŸš€ æ©Ÿèƒ½

- **é‹ç”¨ç®¡ç†**: è»Šä¸¡ã®é‹ç”¨è¨ˆç”»ãƒ»å®Ÿç¸¾ç®¡ç†
- **ä¿å®ˆè¨ˆç”»**: æ¤œæŸ»è¨ˆç”»ãƒ»å®Ÿç¸¾ã®ç®¡ç†
- **è»Šä¸¡ç®¡ç†**: è»Šä¸¡ãƒã‚¹ã‚¿ãƒ»åŸºåœ°ç®¡ç†
- **æ•…éšœç®¡ç†**: æ•…éšœè¨˜éŒ²ãƒ»ä¿®ç†è¨˜éŒ²
- **ãƒ¬ãƒãƒ¼ãƒˆ**: é‹ç”¨ãƒ»ä¿å®ˆã®çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆ

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ

#### ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«
- **management_offices**: ç®¡ç†äº‹æ¥­æ‰€
- **bases**: åŸºåœ°
- **vehicles**: è»Šä¸¡
- **operation_plans**: é‹ç”¨è¨ˆç”»
- **operation_records**: é‹ç”¨å®Ÿç¸¾
- **inspection_plans**: æ¤œæŸ»è¨ˆç”»
- **inspections**: æ¤œæŸ»å®Ÿç¸¾
- **failures**: æ•…éšœè¨˜éŒ²
- **repairs**: ä¿®ç†è¨˜éŒ²
- **maintenance_cycles**: ä¿å®ˆã‚µã‚¤ã‚¯ãƒ«

#### ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
```
management_offices (1) â†â†’ (N) bases
management_offices (1) â†â†’ (N) vehicles
bases (1) â†â†’ (N) vehicles
vehicles (1) â†â†’ (N) operation_plans
vehicles (1) â†â†’ (N) operation_records
vehicles (1) â†â†’ (N) inspection_plans
vehicles (1) â†â†’ (N) inspections
vehicles (1) â†â†’ (N) failures
failures (1) â†â†’ (N) repairs
```

## ğŸ³ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤

### å‰ææ¡ä»¶
- Docker & Docker Compose
- PostgreSQL 15+
- Node.js 18+

### 1. ç’°å¢ƒè¨­å®š

```bash
# æœ¬ç•ªç’°å¢ƒç”¨ã®ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼
cp env.production .env.production

# ç’°å¢ƒå¤‰æ•°ã‚’ç·¨é›†
nano .env.production
```

### 2. ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ

```bash
# æœ¬ç•ªç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤
npm run deploy:production

# ã¾ãŸã¯ç›´æ¥å®Ÿè¡Œ
./deploy.sh production
```

### 3. æ‰‹å‹•ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰
npm run docker:build

# ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•
npm run docker:up

# ãƒ­ã‚°ã‚’ç¢ºèª
npm run docker:logs
```

### 4. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

```bash
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ç¢ºèª
curl http://localhost:3000/api/health

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç¢ºèª
docker-compose -f docker-compose.prod.yml exec postgres pg_isready -U postgres
```

## ğŸ› ï¸ é–‹ç™ºç’°å¢ƒ

### 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install
```

### 2. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

```bash
cp env.example .env.local
# .env.localã‚’ç·¨é›†
```

### 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«PostgreSQLã‚’èµ·å‹•
docker-compose up -d postgres

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
npm run db:setup
```

### 4. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
npm run dev
```

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†

### ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
npm run db:migrate

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
npm run db:backup

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¾©å…ƒ
npm run db:restore
```

### æœ¬ç•ªç’°å¢ƒç”¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```sql
-- scripts/18-production-database-setup.sql ã‚’å®Ÿè¡Œ
-- ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿æŒ¿å…¥
```

## ğŸ”§ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: Next.js 15, React 19, TypeScript
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Next.js API Routes
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: PostgreSQL 15
- **UI**: Tailwind CSS, Radix UI
- **ã‚³ãƒ³ãƒ†ãƒŠ**: Docker, Docker Compose
- **ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·**: Nginx

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
railway-maintenance-system/
â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”œâ”€â”€ api/               # API Routes
â”‚   â”œâ”€â”€ operations/        # é‹ç”¨ç®¡ç†ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ inspections/       # æ¤œæŸ»ç®¡ç†ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ vehicles/          # è»Šä¸¡ç®¡ç†ãƒšãƒ¼ã‚¸
â”‚   â””â”€â”€ failures/          # æ•…éšœç®¡ç†ãƒšãƒ¼ã‚¸
â”œâ”€â”€ components/            # React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ lib/                   # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ types/                 # TypeScriptå‹å®šç¾©
â”œâ”€â”€ scripts/               # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ docker-compose.yml     # é–‹ç™ºç’°å¢ƒ
â”œâ”€â”€ docker-compose.prod.yml # æœ¬ç•ªç’°å¢ƒ
â”œâ”€â”€ nginx.conf            # Nginxè¨­å®š
â””â”€â”€ deploy.sh             # ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- HTTPSå¼·åˆ¶ï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š
- SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–
- ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹æ©Ÿå¯†æƒ…å ±ç®¡ç†

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–
- Gzipåœ§ç¸®
- é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ«è¨­å®š

## ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

1. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼**
   ```bash
   # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®çŠ¶æ…‹ç¢ºèª
   docker-compose logs postgres
   ```

2. **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•ã‚¨ãƒ©ãƒ¼**
   ```bash
   # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°ç¢ºèª
   docker-compose logs app
   ```

3. **ãƒãƒ¼ãƒˆç«¶åˆ**
   ```bash
   # ä½¿ç”¨ä¸­ã®ãƒãƒ¼ãƒˆç¢ºèª
   netstat -tulpn | grep :3000
   ```

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

1. ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
2. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šçŠ¶æ…‹
4. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®š

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚ 